(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-clip-clip~pages-container-container~pages-dynamicCanvasSize-dynamicCanvasSize~pages-image-imag~c309dd95"],{"013f":function(t,e,n){"use strict";function i(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}n.r(e),n.d(e,"default",(function(){return i}))},"0293":function(t,e,n){var i=n("241e"),r=n("53e2");n("ce7e")("getPrototypeOf",(function(){return function(t){return r(i(t))}}))},"061b":function(t,e,n){t.exports=n("fa99")},1496:function(t,e,n){var i=n("d9f6"),r=n("bf0b"),o=n("53e2"),a=n("07e3"),u=n("63b6"),c=n("aebd"),s=n("e4ae"),l=n("f772");function f(t,e,n){var u,h,d=arguments.length<4?t:arguments[3],p=r.f(s(t),e);if(!p){if(l(h=o(t)))return f(h,e,n,d);p=c(0)}if(a(p,"value")){if(!1===p.writable||!l(d))return!1;if(u=r.f(d,e)){if(u.get||u.set||!1===u.writable)return!1;u.value=n,i.f(d,e,u)}else i.f(d,e,c(0,n));return!0}return void 0!==p.set&&(p.set.call(d,n),!0)}u(u.S,"Reflect",{set:f})},"1af6":function(t,e,n){var i=n("63b6");i(i.S,"Array",{isArray:n("9003")})},"1cb7":function(t,e,n){var i=n("bf0b"),r=n("53e2"),o=n("07e3"),a=n("63b6"),u=n("f772"),c=n("e4ae");function s(t,e){var n,a,l=arguments.length<3?t:arguments[2];return c(t)===l?t[e]:(n=i.f(t,e))?o(n,"value")?n.value:void 0!==n.get?n.get.call(l):void 0:u(a=r(t))?s(a,e,l):void 0}a(a.S,"Reflect",{get:s})},"1df8":function(t,e,n){var i=n("63b6");i(i.S,"Object",{setPrototypeOf:n("ead6").set})},"20fd":function(t,e,n){"use strict";var i=n("d9f6"),r=n("aebd");t.exports=function(t,e,n){e in t?i.f(t,e,r(0,n)):t[e]=n}},"25b0":function(t,e,n){n("1df8"),t.exports=n("584a").Object.setPrototypeOf},"268f":function(t,e,n){t.exports=n("fde4")},"2a88":function(t,e,n){"use strict";n.r(e),n.d(e,"default",(function(){return c}));var i=n("268f"),r=n.n(i),o=n("8feb"),a=n.n(o),u=n("a04a");function c(t,e,n){return c="undefined"!==typeof Reflect&&a.a?a.a:function(t,e,n){var i=Object(u["a"])(t,e);if(i){var o=r()(i,e);return o.get?o.get.call(n):o.value}},c(t,e,n||t)}},"308d":function(t,e,n){"use strict";n.r(e),n.d(e,"default",(function(){return o}));var i=n("7618"),r=n("013f");function o(t,e){return!e||"object"!==Object(i["default"])(e)&&"function"!==typeof e?Object(r["default"])(t):e}},"469f":function(t,e,n){n("6c1c"),n("1654"),t.exports=n("7d7b")},4910:function(t,e,n){n("1cb7"),t.exports=n("584a").Reflect.get},"4aa6":function(t,e,n){t.exports=n("dc62")},"4d16":function(t,e,n){t.exports=n("25b0")},"4e2b":function(t,e,n){"use strict";n.r(e),n.d(e,"default",(function(){return c}));var i=n("4aa6"),r=n.n(i),o=n("4d16"),a=n.n(o);function u(t,e){return u=a.a||function(t,e){return t.__proto__=e,t},u(t,e)}function c(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=r()(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&u(t,e)}},"549b":function(t,e,n){"use strict";var i=n("d864"),r=n("63b6"),o=n("241e"),a=n("b0dc"),u=n("3702"),c=n("b447"),s=n("20fd"),l=n("7cd6");r(r.S+r.F*!n("4ee1")((function(t){Array.from(t)})),"Array",{from:function(t){var e,n,r,f,h=o(t),d="function"==typeof this?this:Array,p=arguments.length,v=p>1?arguments[1]:void 0,y=void 0!==v,m=0,w=l(h);if(y&&(v=i(v,p>2?arguments[2]:void 0,2)),void 0==w||d==Array&&u(w))for(e=c(h.length),n=new d(e);e>m;m++)s(n,m,y?v(h[m],m):h[m]);else for(f=w.call(h),n=new d;!(r=f.next()).done;m++)s(n,m,y?a(f,v,[r.value,m],!0):r.value);return n.length=m,n}})},"54a1":function(t,e,n){n("6c1c"),n("1654"),t.exports=n("95d5")},"5d73":function(t,e,n){t.exports=n("469f")},"62de":function(t,e,n){"use strict";n.r(e),n.d(e,"default",(function(){return h}));var i=n("85f2"),r=n.n(i),o=n("268f"),a=n.n(o),u=n("d3d7"),c=n.n(u),s=n("a04a"),l=n("bd86");function f(t,e,n,i){return f="undefined"!==typeof Reflect&&c.a?c.a:function(t,e,n,i){var o,u=Object(s["a"])(t,e);if(u){if(o=a()(u,e),o.set)return o.set.call(i,n),!0;if(!o.writable)return!1}if(o=a()(i,e),o){if(!o.writable)return!1;o.value=n,r()(i,e,o)}else Object(l["default"])(i,e,n);return!0},f(t,e,n,i)}function h(t,e,n,i,r){var o=f(t,e,n,i||t);if(!o&&r)throw new Error("failed to set property");return n}},"6bb5":function(t,e,n){"use strict";n.r(e),n.d(e,"default",(function(){return u}));var i=n("061b"),r=n.n(i),o=n("4d16"),a=n.n(o);function u(t){return u=a.a?r.a:function(t){return t.__proto__||r()(t)},u(t)}},"6c7b":function(t,e,n){var i=n("5ca1");i(i.P,"Array",{fill:n("36bd")}),n("9c6c")("fill")},"75fc":function(t,e,n){"use strict";n.r(e),n.d(e,"default",(function(){return y}));var i=n("a745"),r=n.n(i),o=n("db2a");function a(t){if(r()(t))return Object(o["a"])(t)}var u=n("774e"),c=n.n(u),s=n("c8bb"),l=n.n(s),f=n("67bb"),h=n.n(f);function d(t){if("undefined"!==typeof h.a&&l()(Object(t)))return c()(t)}var p=n("e630");function v(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function y(t){return a(t)||d(t)||Object(p["a"])(t)||v()}},"768b":function(t,e,n){"use strict";n.r(e),n.d(e,"default",(function(){return v}));var i=n("a745"),r=n.n(i);function o(t){if(r()(t))return t}var a=n("5d73"),u=n.n(a),c=n("c8bb"),s=n.n(c),l=n("67bb"),f=n.n(l);function h(t,e){if("undefined"!==typeof f.a&&s()(Object(t))){var n=[],i=!0,r=!1,o=void 0;try{for(var a,c=u()(t);!(i=(a=c.next()).done);i=!0)if(n.push(a.value),e&&n.length===e)break}catch(l){r=!0,o=l}finally{try{i||null==c["return"]||c["return"]()}finally{if(r)throw o}}return n}}var d=n("e630");function p(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function v(t,e){return o(t)||h(t,e)||Object(d["a"])(t,e)||p()}},"774e":function(t,e,n){t.exports=n("d2d5")},"7d7b":function(t,e,n){var i=n("e4ae"),r=n("7cd6");t.exports=n("584a").getIterator=function(t){var e=r(t);if("function"!=typeof e)throw TypeError(t+" is not iterable!");return i(e.call(t))}},"8e9e":function(t,e,n){n("1496"),t.exports=n("584a").Reflect.set},"8feb":function(t,e,n){t.exports=n("4910")},9427:function(t,e,n){var i=n("63b6");i(i.S,"Object",{create:n("a159")})},"95d5":function(t,e,n){var i=n("40c3"),r=n("5168")("iterator"),o=n("481b");t.exports=n("584a").isIterable=function(t){var e=Object(t);return void 0!==e[r]||"@@iterator"in e||o.hasOwnProperty(i(e))}},a04a:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var i=n("6bb5");function r(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=Object(i["default"])(t),null===t)break;return t}},a745:function(t,e,n){t.exports=n("f410")},b0b4:function(t,e,n){"use strict";n.r(e),n.d(e,"default",(function(){return a}));var i=n("85f2"),r=n.n(i);function o(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),r()(t,i.key,i)}}function a(t,e,n){return e&&o(t.prototype,e),n&&o(t,n),t}},b39a:function(t,e,n){var i=n("d3f4");t.exports=function(t,e){if(!i(t)||t._t!==e)throw TypeError("Incompatible receiver, "+e+" required!");return t}},bf90:function(t,e,n){var i=n("36c3"),r=n("bf0b").f;n("ce7e")("getOwnPropertyDescriptor",(function(){return function(t,e){return r(i(t),e)}}))},c26b:function(t,e,n){"use strict";var i=n("86cc").f,r=n("2aeb"),o=n("dcbc"),a=n("9b43"),u=n("f605"),c=n("4a59"),s=n("01f9"),l=n("d53b"),f=n("7a56"),h=n("9e1e"),d=n("67ab").fastKey,p=n("b39a"),v=h?"_s":"size",y=function(t,e){var n,i=d(e);if("F"!==i)return t._i[i];for(n=t._f;n;n=n.n)if(n.k==e)return n};t.exports={getConstructor:function(t,e,n,s){var l=t((function(t,i){u(t,l,e,"_i"),t._t=e,t._i=r(null),t._f=void 0,t._l=void 0,t[v]=0,void 0!=i&&c(i,n,t[s],t)}));return o(l.prototype,{clear:function(){for(var t=p(this,e),n=t._i,i=t._f;i;i=i.n)i.r=!0,i.p&&(i.p=i.p.n=void 0),delete n[i.i];t._f=t._l=void 0,t[v]=0},delete:function(t){var n=p(this,e),i=y(n,t);if(i){var r=i.n,o=i.p;delete n._i[i.i],i.r=!0,o&&(o.n=r),r&&(r.p=o),n._f==i&&(n._f=r),n._l==i&&(n._l=o),n[v]--}return!!i},forEach:function(t){p(this,e);var n,i=a(t,arguments.length>1?arguments[1]:void 0,3);while(n=n?n.n:this._f){i(n.v,n.k,this);while(n&&n.r)n=n.p}},has:function(t){return!!y(p(this,e),t)}}),h&&i(l.prototype,"size",{get:function(){return p(this,e)[v]}}),l},def:function(t,e,n){var i,r,o=y(t,e);return o?o.v=n:(t._l=o={i:r=d(e,!0),k:e,v:n,p:i=t._l,n:void 0,r:!1},t._f||(t._f=o),i&&(i.n=o),t[v]++,"F"!==r&&(t._i[r]=o)),t},getEntry:y,setStrong:function(t,e,n){s(t,e,(function(t,n){this._t=p(t,e),this._k=n,this._l=void 0}),(function(){var t=this,e=t._k,n=t._l;while(n&&n.r)n=n.p;return t._t&&(t._l=n=n?n.n:t._t._f)?l(0,"keys"==e?n.k:"values"==e?n.v:[n.k,n.v]):(t._t=void 0,l(1))}),n?"entries":"values",!n,!0),f(e)}}},c8bb:function(t,e,n){t.exports=n("54a1")},ce7e:function(t,e,n){var i=n("63b6"),r=n("584a"),o=n("294c");t.exports=function(t,e){var n=(r.Object||{})[t]||Object[t],a={};a[t]=e(n),i(i.S+i.F*o((function(){n(1)})),"Object",a)}},d109:function(t,e,n){"use strict";var i=n("4ea4");n("6b54"),n("2397"),n("6762"),n("2fdb");var r=i(n("013f"));n("1c4c"),n("6c7b");var o=i(n("768b")),a=i(n("2a88")),u=i(n("62de"));n("fd24"),n("8e6e"),n("5df3"),n("f400"),n("28a5"),n("a481");var c=i(n("75fc"));n("ac6a");var s=i(n("4e2b")),l=i(n("308d")),f=i(n("6bb5"));n("96cf");var h=i(n("d225")),d=i(n("b0b4")),p=i(n("7618"));function v(t,e){var n;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=y(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw o}}}}function y(t,e){if(t){if("string"===typeof t)return m(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?m(t,e):void 0}}function m(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function w(t){var e=x();return function(){var n,i=(0,f.default)(t);if(e){var r=(0,f.default)(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return(0,l.default)(this,n)}}function x(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}n("ac4d"),n("8a81"),t.exports=function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==(0,p.default)(t)&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(i,r,function(e){return t[e]}.bind(null,r));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){n.r(e),n.d(e,"default",(function(){return it}));var i="object"==("undefined"===typeof swan?"undefined":(0,p.default)(swan))?"mp-baidu":"object"==("undefined"===typeof my?"undefined":(0,p.default)(my))?"mp-alipay":"object"==("undefined"===typeof wx?"undefined":(0,p.default)(wx))?"mp-weixin":"object"==("undefined"===typeof window?"undefined":(0,p.default)(window))?"h5":"mp-weixin",l=function(){if("undefined"!=typeof uni)return uni;if("undefined"!=typeof wx)return wx;if("undefined"!=typeof window)return{upx2px:function(t){return t},getSystemInfoSync:function(){return{screenWidth:window.innerWidth}},downloadFile:function(t){var e;return null===(e=t.success)||void 0===e?void 0:e.call(t,{tempFilePath:t.url})}};throw new Error("enviroment not support")}(),y=function(t,e,n,i){return new(n||(n=Promise))((function(r,o){function a(t){try{c(i.next(t))}catch(t){o(t)}}function u(t){try{c(i.throw(t))}catch(t){o(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}c((i=i.apply(t,e||[])).next())}))},m=function(){function t(e,n,i){var r,o,a;(0,h.default)(this,t),this.offsetTop=0,this.offsetLeft=0,this.contentHeight=0,this.contentWidth=0,this.painter=e,this.parent=i,this.position=null!==(r=n.position)&&void 0!==r?r:"static",this.left=null!==(o=n.left)&&void 0!==o?o:0,this.top=null!==(a=n.top)&&void 0!==a?a:0}return(0,d.default)(t,[{key:"layout",value:function(){return y(this,void 0,void 0,regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this._layout();case 2:return e=t.sent,t.abrupt("return",(this.contentHeight=e.height,this.contentWidth=e.width,e));case 4:case"end":return t.stop()}}),t,this)})))}},{key:"anchorX",get:function(){var t,e;return null!==(e=null===(t=this.parent)||void 0===t?void 0:t.elementX)&&void 0!==e?e:0}},{key:"anchorY",get:function(){var t,e;return null!==(e=null===(t=this.parent)||void 0===t?void 0:t.elementY)&&void 0!==e?e:0}},{key:"elementX",get:function(){switch(this.position){case"absolute":return this.left+this.anchorX;case"static":return this.left+this.offsetLeft+this.anchorX;default:throw new TypeError("unknown position type")}}},{key:"elementY",get:function(){switch(this.position){case"absolute":return this.top+this.anchorY;case"static":return this.top+this.offsetTop+this.anchorY;default:throw new TypeError("unknown position type")}}},{key:"offsetHeight",get:function(){return this.top+this.contentHeight}},{key:"offsetWidth",get:function(){return this.left+this.contentWidth}}]),t}(),x=function(t){(0,s.default)(n,t);var e=w(n);function n(t,i){var r;return(0,h.default)(this,n),r=e.call(this,t),r.option=i,r}return(0,d.default)(n,[{key:"style",get:function(){var t=this.painter,e=t.ctx,n=t.upx2px,i=this.option,r=i.x1,o=i.x2,a=i.y1,u=i.y2,c=e.createLinearGradient(n(this.element.elementX+r),n(this.element.elementY+a),n(this.element.elementX+o),n(this.element.elementY+u));return this.option.colorStops.forEach((function(t){c.addColorStop(t.offset,t.color)})),c}}]),n}(function(){function t(e){(0,h.default)(this,t),this.element=e}return(0,d.default)(t,[{key:"painter",get:function(){return this.element.painter}}]),t}());function b(t,e){if("string"==typeof e)return e;switch(e.type){case"linear-gradient":return new x(t,e).style;default:throw new Error("Unkwon option type")}}function g(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return n%2?[Math.floor(t)+.5,Math.floor(e)+.5]:[Math.round(t),Math.round(e)]}var k=function(t){(0,s.default)(n,t);var e=w(n);function n(t,i,r){var o,a,u,c,s,l;return(0,h.default)(this,n),o=e.call(this,t,i,r),o.option={dx:null!==(a=i.dx)&&void 0!==a?a:0,dy:null!==(u=i.dy)&&void 0!==u?u:0,color:null!==(c=i.color)&&void 0!==c?c:"#000",dashPattern:null!==(s=i.dashPattern)&&void 0!==s?s:[1,0],lineWidth:null!==(l=i.lineWidth)&&void 0!==l?l:1},o}return(0,d.default)(n,[{key:"_layout",value:function(){return{width:this.option.dx,height:this.option.dy}}},{key:"paint",value:function(){var t,e,n=this,i=this.painter.upx2px(this.elementX),r=this.painter.upx2px(this.elementY),o=this.painter.upx2px(this.elementX+this.option.dx),a=this.painter.upx2px(this.elementY+this.option.dy),u=this.painter.upx2px(this.option.lineWidth);this.painter.ctx.beginPath(),(t=this.painter.ctx).moveTo.apply(t,(0,c.default)(g(i,r,u))),(e=this.painter.ctx).lineTo.apply(e,(0,c.default)(g(o,a,u))),this.painter.ctx.setLineDash(this.option.dashPattern.map((function(t){return n.painter.upx2px(t)}))),this.painter.ctx.setStrokeStyle(b(this,this.option.color)),this.painter.ctx.lineWidth=u,this.painter.ctx.stroke()}}]),n}(m);function S(t){return t.replace(/[\n\r]/g,"")}var O=function(t){(0,s.default)(n,t);var e=w(n);function n(t,i,r){var o,a,u,c,s,l,f,d,p,v,y;return(0,h.default)(this,n),o=e.call(this,t,i,r),o.option={color:null!==(a=i.color)&&void 0!==a?a:"#000",align:null!==(u=i.align)&&void 0!==u?u:"left",fontWeight:null!==(c=i.fontWeight)&&void 0!==c?c:"normal",fontStyle:null!==(s=i.fontStyle)&&void 0!==s?s:"normal",fontFamily:null!==(l=i.fontFamily)&&void 0!==l?l:"serial",fontSize:null!==(f=i.fontSize)&&void 0!==f?f:30,baseline:null!==(d=i.baseline)&&void 0!==d?d:"top",content:null!==(p=i.content)&&void 0!==p?p:"",width:null!==(v=i.width)&&void 0!==v?v:void 0,textDecoration:null!==(y=i.textDecoration)&&void 0!==y?y:"none"},o.option.content=S(o.option.content),o}return(0,d.default)(n,[{key:"_layout",value:function(){var t;return{width:null!==(t=this.option.width)&&void 0!==t?t:this.painter.ctx.measureTextWidth(this.option.content,this.option.fontSize),height:this.option.fontSize}}},{key:"paint",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.inTextBlock,n=void 0!==e&&e;this.painter.ctx.font=["normal"!=this.option.fontWeight&&this.option.fontWeight,"normal"!=this.option.fontStyle&&this.option.fontStyle,this.painter.upx2px(this.option.fontSize)+"px",this.option.fontFamily].filter(Boolean).join(" "),n||this.painter.ctx.setFillStyle(b(this,this.option.color)),this.painter.ctx.setFontSize(this.painter.upx2px(this.option.fontSize)),this.painter.ctx.setTextBaseline(this.option.baseline),this.painter.ctx.setTextAlign(this.option.align),this.painter.ctx.fillText(this.option.content,this.painter.upx2px(this.elementX),this.painter.upx2px(this.elementY)),console.debug("mp-painter:fillText:",this.option.content,"x=",this.elementX,"y=",this.elementY),this.paintTextDecoration()}},{key:"paintTextDecoration",value:function(){"line-through"==this.option.textDecoration&&new k(this.painter,{top:this.elementY+.4*this.option.fontSize,left:this.elementX,dx:this.contentWidth,dy:0,color:this.option.color}).paint()}}]),n}(m),j=function(){function t(e){(0,h.default)(this,t),this.fontSize=e.fontSize,this.lineClamp=e.lineClamp||1/0,this.width=e.width,this.ctx=e.painter.ctx,this.painter=e.painter,this.content=e.content,this.lines=[],this.currentLineText="",this.position=0,this.endPostion=this.position,this.isOverflow=!1,this.isDry=!1,this.isFull=!1}return(0,d.default)(t,[{key:"split",value:function(){return this.painter.ctx.setFontSize(this.fontSize),this.fillText(),this.lines}},{key:"minCharNumberInWidth",value:function(t){return Math.ceil(t/this.fontSize)}},{key:"freeSpaceInCurrentLine",value:function(){if(this.currentLineText.length){var t=this.painter.ctx.measureTextWidth(this.currentLineText,this.fontSize);return this.width-(t||0)}return this.width}},{key:"adjustCharNumberInCurrentLine",value:function(t){var e=this.currentLineText.length+t,n=this.content.length;e=Math.min(e,n),this.isDry=e==n,this.currentLineText=this.content.slice(0,e)}},{key:"commitLine",value:function(){this.content=this.content.slice(this.currentLineText.length),this.lines.push(this.currentLineText),this.currentLineText="",this.lines.length==this.lineClamp&&(this.isFull=!0,0==this.isDry&&(this.isOverflow=!0))}},{key:"handleOverflow",value:function(){var t=this.lines.pop();t=t.substring(0,Math.max(0,t.length-1))+"...",this.lines.push(t)}},{key:"fillText",value:function(){var t=this.freeSpaceInCurrentLine();if(t<=0){if(this.adjustCharNumberInCurrentLine(-1),this.commitLine(),this.isOverflow&&this.handleOverflow(),this.isFull)return;t=this.freeSpaceInCurrentLine()}else if(this.isDry)return void this.commitLine();var e=this.minCharNumberInWidth(t);this.adjustCharNumberInCurrentLine(e),this.fillText()}}]),t}(),T=function(t,e,n,i){return new(n||(n=Promise))((function(r,o){function a(t){try{c(i.next(t))}catch(t){o(t)}}function u(t){try{c(i.throw(t))}catch(t){o(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}c((i=i.apply(t,e||[])).next())}))},R=function(t){(0,s.default)(n,t);var e=w(n);function n(t,i,r){var o,a,u,c,s,l,f,d;return(0,h.default)(this,n),o=e.call(this,t,i,r),o.option=Object.assign(Object.assign({},i),{width:null!==(a=i.width)&&void 0!==a?a:100,height:null!==(u=i.height)&&void 0!==u?u:"auto",fontSize:null!==(c=i.fontSize)&&void 0!==c?c:30,content:null!==(s=i.content)&&void 0!==s?s:"",lineHeight:null!==(l=i.lineHeight)&&void 0!==l?l:40,lineClamp:null!==(f=i.lineClamp)&&void 0!==f?f:0,color:null!==(d=i.color)&&void 0!==d?d:"black"}),o.lines=[],o.option.content=S(o.option.content),o}return(0,d.default)(n,[{key:"_layout",value:function(){return this.lines=new j({fontSize:this.option.fontSize,lineClamp:this.option.lineClamp,width:this.option.width,painter:this.painter,content:this.option.content}).split(),{width:this.option.width,height:"auto"==this.option.height?(this.lines.length-1)*this.option.lineHeight+this.option.fontSize:this.option.height}}},{key:"paint",value:function(){return T(this,void 0,void 0,regeneratorRuntime.mark((function t(){var e=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:this.painter.ctx.setFillStyle(b(this,this.option.color)),this.lines.map((function(t,n){var i=Object.assign(Object.assign({},e.option),{type:"text",top:e.elementY+n*e.option.lineHeight,left:e.elementX,position:e.position,content:t});return new O(e.painter,i)})).forEach((function(t){return t.paint({inTextBlock:!0})}));case 1:case"end":return t.stop()}}),t,this)})))}}]),n}(m);function _(t){var e=new Map;return function(n){return e.has(n)||e.set(n,t(n)),e.get(n)}}function P(){var t=!1,e=function(t){var e=Object.getOwnPropertyDescriptors(Object.getPrototypeOf(t)),n={},i=function(t){var i=e[t],r={};r.enumerable=i.enumerable,r.configurable=i.configurable,i.value&&"function"==typeof i.value&&(r.value=function(){for(var t,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(t=i.value).call.apply(t,[this.context].concat(n))}),i.value&&"function"!=typeof i.value&&(r.get=function(){return this.context[t]},r.set=function(e){this.context[t]=e}),i.get&&(r.get=function(){var t;return null===(t=i.get)||void 0===t?void 0:t.call(this.context)}),i.set&&(r.set=function(t){var e;null===(e=i.set)||void 0===e||e.call(this.context,t)}),n[t]=r};for(var r in e)i(r);return Object.defineProperties({},n)},n=function n(i){if(!(this instanceof n))throw new Error("mp-painter: `this` is not instance of `constructor`");if(this.context=i,!t)for(var r=this,o=Object.getPrototypeOf(r);null!==o;r=o,o=Object.getPrototypeOf(r))if(r.constructor===n){Object.setPrototypeOf(r,e(this.context)),t=!0;break}};return n}var W=function(t,e,n,i){return new(n||(n=Promise))((function(r,o){function a(t){try{c(i.next(t))}catch(t){o(t)}}function u(t){try{c(i.throw(t))}catch(t){o(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}c((i=i.apply(t,e||[])).next())}))},I=function(t){(0,s.default)(n,t);var e=w(n);function n(t,i){var r;return(0,h.default)(this,n),r=e.call(this,i),r.painter=t,r}return(0,d.default)(n,[{key:"draw",value:function(t,e){e()}},{key:"setFillStyle",value:function(t){(0,u.default)((0,f.default)(n.prototype),"fillStyle",t,this,!0)}},{key:"setStrokeStyle",value:function(t){(0,u.default)((0,f.default)(n.prototype),"strokeStyle",t,this,!0)}},{key:"drawImageWithSrc",value:function(t,e,i,r,o,u,c,s,l){var h=this,d=Object.create(null,{drawImage:{get:function(){return(0,a.default)((0,f.default)(n.prototype),"drawImage",h)}}});return W(this,void 0,void 0,regeneratorRuntime.mark((function n(){var a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,F(t);case 2:a=n.sent,"number"==typeof u&&"number"==typeof c&&"number"==typeof s&&"number"==typeof l?d.drawImage.call(this,a,e,i,r,o,u,c,s,l):d.drawImage.call(this,a,e,i,r,o);case 4:case"end":return n.stop()}}),n,this)})))}},{key:"setTextAlign",value:function(t){(0,u.default)((0,f.default)(n.prototype),"textAlign",t,this,!0)}},{key:"setTextBaseline",value:function(t){(0,u.default)((0,f.default)(n.prototype),"textBaseline","normal"===t?"alphabetic":t,this,!0)}},{key:"setFontSize",value:function(t){var e,i;console.debug("set font size for h5, before is %s after is %s",(0,a.default)((0,f.default)(n.prototype),"font",this),null===(e=(0,a.default)((0,f.default)(n.prototype),"font",this))||void 0===e?void 0:e.replace(/\b\w+px\b/,this.painter.upx2px(t)+"px sans-serif")),(0,u.default)((0,f.default)(n.prototype),"font",null===(i=(0,a.default)((0,f.default)(n.prototype),"font",this))||void 0===i?void 0:i.replace(/\b\w+px\b/,this.painter.upx2px(t)+"px"),this,!0)}},{key:"measureTextWidth",value:function(t,e){this.setFontSize(e);var n=this.measureText(t).width;return console.debug('measureText: result of measure text "%s" with font size %s is %s',t,this.font,n),null!=n?n:0}}]),n}(P());function F(t){var e=new Image;return e.src=t,new Promise((function(t){return e.addEventListener("load",(function(n){return t(e)}),{once:!0})}))}var E=function(t,e,n,i){return new(n||(n=Promise))((function(r,o){function a(t){try{c(i.next(t))}catch(t){o(t)}}function u(t){try{c(i.throw(t))}catch(t){o(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}c((i=i.apply(t,e||[])).next())}))},z=_((function(t){return E(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n,i,r,o,a,u;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(u=uni.getImageInfo,function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new Promise((function(e,n){t.success=e,t.fail=n,u(t)}))})({src:t});case 3:return n=e.sent,i=n.width,r=void 0===i?100:i,o=n.height,a=void 0===o?100:o,e.abrupt("return",{width:r,height:a});case 11:return e.prev=11,e.t0=e["catch"](0),e.abrupt("return",(console.log("mp-painter:getImageOriginSize: fail, use default size: width = 100, height = 100"),{width:100,height:100}));case 14:case"end":return e.stop()}}),e,null,[[0,11]])})))})),C=_((function(t){return E(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,F(t);case 2:return n=e.sent,e.abrupt("return",{width:n.naturalWidth,height:n.naturalHeight});case 4:case"end":return e.stop()}}),e)})))})),M=function(t){(0,s.default)(n,t);var e=w(n);function n(t,i,r){var o,a,u,c,s;return(0,h.default)(this,n),o=e.call(this,t,i,r),o.option={width:null!==(a=i.width)&&void 0!==a?a:100,height:null!==(u=i.height)&&void 0!==u?u:100,objectFit:null!==(c=i.objectFit)&&void 0!==c?c:"fill",objectPosition:null!==(s=i.objectPosition)&&void 0!==s?s:["center","center"],src:i.src},o}return(0,d.default)(n,[{key:"_layout",value:function(){return{width:this.option.width,height:this.option.height}}},{key:"paint",value:function(){return E(this,void 0,void 0,regeneratorRuntime.mark((function t(){var e,n,i,r,a,u,c,s,f,h,d;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e=this.painter.upx2px,this.option.src){t.next=3;break}return t.abrupt("return");case 3:return t.next=5,function(t,e){return E(this,void 0,void 0,regeneratorRuntime.mark((function n(){var i,r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(i=t.platform,!("h5"!=i&&/^\./.test(e.src)||"h5"!=i&&/^\/static/.test(e.src)||"h5"!=i&&/^data:image\//.test(e.src)||"mp-alipay"==i&&/^https:\/\/resource\//.test(e.src)||"mp-weixin"==i&&/^wxfile:/.test(e.src)||"mp-baidu"==i&&/^bdfile:\/\/tmp/.test(e.src))){n.next=5;break}n.t0=e.src,n.next=14;break;case 5:if(console.log("mp-painter:绘制图片: 下载图片文件:",e.src),"h5"!=i){n.next=10;break}n.t1=e.src,n.next=13;break;case 10:return n.next=12,(r=e.src,new Promise((function(t,e){return l.downloadFile({url:r,success:function(e){return t(e.tempFilePath)},fail:e})}))).catch((function(t){return console.log("mp-painter:下载错误: ",t),""}));case 12:n.t1=n.sent;case 13:n.t0=n.t1;case 14:return n.abrupt("return",n.t0);case 15:case"end":return n.stop()}}),n)})))}(this.painter,this.option);case 5:if(n=t.sent,!n){t.next=27;break}if(console.log("mp-painter:调用小程序drawImage，使用:",n),"fill"==this.option.objectFit){t.next=26;break}return t.t0=function(t,e,n){var i,r,a=e.width/e.height,u=n.width/n.height,c=1;if(a>u&&"contain"==t.objectFit||a<=u&&"cover"==t.objectFit)c=n.width/e.width;else{if(!(a>u&&"cover"==t.objectFit||a<=u&&"contain"==t.objectFit))throw new Error("Unkonwn concreteScale");c=n.height/e.height}var s=e.width*c,l=e.height*c,f={left:0,center:.5,right:1}[(null===(i=t.objectPosition)||void 0===i?void 0:i[0])||"center"],h={top:0,center:.5,bottom:1}[(null===(r=t.objectPosition)||void 0===r?void 0:r[1])||"center"],d=(n.width-s)*f,p=(n.height-l)*h,v=function(t,e){return[(t-d)/c,(e-p)/c]},y=v(0,0),m=(0,o.default)(y,2),w=m[0],x=m[1],b=v(n.width,n.height),g=(0,o.default)(b,2),k=g[0],S=g[1];return{sx:Math.max(w,0),sy:Math.max(x,0),sw:Math.min(k-w,e.width),sh:Math.min(S-x,e.height),dx:Math.max(d,0),dy:Math.max(p,0),dw:Math.min(s,n.width),dh:Math.min(l,n.height)}},t.t1={objectFit:this.option.objectFit,objectPosition:this.option.objectPosition},t.next=12,("h5"==this.painter.platform?C:z)(n);case 12:t.t2=t.sent,t.t3={width:this.option.width,height:this.option.height},i=(0,t.t0)(t.t1,t.t2,t.t3),r=i.sx,a=i.sy,u=i.sh,c=i.sw,s=i.dx,f=i.dy,h=i.dh,d=i.dw,this.painter.ctx.drawImageWithSrc(n,r,a,c,u,e(s+this.elementX),e(f+this.elementY),e(d),e(h)),t.next=27;break;case 26:this.painter.ctx.drawImageWithSrc(n,e(this.elementX),e(this.elementY),e(this.option.width),e(this.option.height));case 27:case"end":return t.stop()}}),t,this)})))}}]),n}(m),L=function(t){(0,s.default)(n,t);var e=w(n);function n(t,i){var r;return(0,h.default)(this,n),r=e.call(this,t,i),r.option=i,r.option.borderRadius&&r.assertBorderRadius(),r}return(0,d.default)(n,[{key:"assertBorderRadius",value:function(){this.normalizedBorderRadius.some((function(t){return t<0}))&&(console.warn("mp-painter:border radius must greater than 0, got:",this.normalizedBorderRadius.join(",")),this.option.borderRadius=0)}},{key:"paint",value:function(){this.reduceBorderRadius();var t=this.painter,e=t.ctx,n=t.upx2px,i=n(this.pathX),r=n(this.pathY),a=n(this.option.height),u=n(this.option.width),c=this.normalizedBorderRadius.map((function(t){return n(t)})),s=(0,o.default)(c,4),l=s[0],f=s[1],h=s[2],d=s[3];e.beginPath(),e.moveTo(i,r+l),e.arcTo(i,r,i+l,r,l),e.arcTo(i+u,r,i+u,r+f,f),e.arcTo(i+u,r+a,i+u-h,r+a,h),e.arcTo(i,r+a,i,r+a-d,d),e.closePath()}},{key:"reduceBorderRadius",value:function(){var t=(0,o.default)(this.normalizedBorderRadius,4),e=t[0],n=t[1],i=t[2],r=t[3],a=Math.min(this.option.width/(e+n),this.option.height/(n+i),this.option.width/(r+i),this.option.height/(e+r));a>=1||(this.option.borderRadius=this.normalizedBorderRadius.map((function(t){return t*a})))}},{key:"normalizedBorderRadius",get:function(){return"number"==typeof this.option.borderRadius?Array.from({length:4}).fill(this.option.borderRadius):(0,c.default)(this.option.borderRadius)}}]),n}(function(){function t(e,n){var i,r;(0,h.default)(this,t),this.element=e,this.left=null!==(i=n.left)&&void 0!==i?i:0,this.top=null!==(r=n.top)&&void 0!==r?r:0}return(0,d.default)(t,[{key:"painter",get:function(){return this.element.painter}},{key:"pathX",get:function(){return this.element.elementX+this.left}},{key:"pathY",get:function(){return this.element.elementY+this.top}}]),t}());function A(t,e){switch(e.type){case"rounded-rect":return new L(t,e);default:throw new Error("Unkwon option type")}}var X=function(t){(0,s.default)(n,t);var e=w(n);function n(t,i,r){var o,a,u,c,s,l,f,d;return(0,h.default)(this,n),o=e.call(this,t,i,r),o.option={width:null!==(a=i.width)&&void 0!==a?a:100,height:null!==(u=i.height)&&void 0!==u?u:100,borderRadius:null!==(c=i.borderRadius)&&void 0!==c?c:0,background:null!==(s=i.background)&&void 0!==s?s:"transparent",borderStyle:null!==(l=i.borderStyle)&&void 0!==l?l:"solid",borderWidth:null!==(f=i.borderWidth)&&void 0!==f?f:0,borderColor:null!==(d=i.borderColor)&&void 0!==d?d:"#000"},o}return(0,d.default)(n,[{key:"_layout",value:function(){return{width:this.option.width,height:this.option.height}}},{key:"paint",value:function(){(this.shouldFill||this.shouldStroke)&&(this.option.borderRadius?this.paintByPath():this.paintByRect())}},{key:"applyFillStyle",value:function(){this.painter.ctx.setFillStyle(b(this,this.option.background))}},{key:"applyStrokeStyle",value:function(){var t,e;this.painter.ctx.setLineDash((t=this.option.borderStyle,{dashed:[e=this.option.borderWidth,e],solid:[10,0]}[t])),this.painter.ctx.lineWidth=this.painter.upx2px(this.option.borderWidth),this.painter.ctx.setStrokeStyle(this.option.borderColor)}},{key:"paintByRect",value:function(){var t,e,n=[this.painter.upx2px(this.elementX),this.painter.upx2px(this.elementY),this.painter.upx2px(this.option.width),this.painter.upx2px(this.option.height)];this.shouldFill&&(this.applyFillStyle(),(t=this.painter.ctx).fillRect.apply(t,n)),this.shouldStroke&&(this.applyStrokeStyle(),(e=this.painter.ctx).strokeRect.apply(e,n))}},{key:"paintByPath",value:function(){A(this,{type:"rounded-rect",height:this.option.height,width:this.option.width,borderRadius:this.option.borderRadius}).paint(),this.shouldFill&&(this.painter.ctx.setFillStyle(b(this,this.option.background)),this.painter.ctx.fill()),this.shouldStroke&&(this.applyStrokeStyle(),this.painter.ctx.stroke())}},{key:"shouldFill",get:function(){return"trasparent"!==this.option.background}},{key:"shouldStroke",get:function(){return this.option.borderWidth>0}}]),n}(m),Y=function(t,e,n,i){return new(n||(n=Promise))((function(r,o){function a(t){try{c(i.next(t))}catch(t){o(t)}}function u(t){try{c(i.throw(t))}catch(t){o(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}c((i=i.apply(t,e||[])).next())}))},B=function(t){(0,s.default)(n,t);var e=w(n);function n(t,i,o){var a,u,c,s,l;return(0,h.default)(this,n),a=e.call(this,t,i,o),a.childOffsetTop=0,a.childOffsetLeft=0,a.option={direction:null!==(u=i.direction)&&void 0!==u?u:"vertical",width:null!==(c=i.width)&&void 0!==c?c:"auto",height:null!==(s=i.height)&&void 0!==s?s:"auto",children:null!==(l=i.children)&&void 0!==l?l:[]},a.children=a.option.children.map((function(t){return J(a.painter,t,(0,r.default)(a))})),a}return(0,d.default)(n,[{key:"_layout",value:function(){return Y(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.layoutChildren();case 2:return t.abrupt("return",{width:this.calcContainerWidth(),height:this.calcContainerHeight()});case 3:case"end":return t.stop()}}),t,this)})))}},{key:"layoutChildren",value:function(){return Y(this,void 0,void 0,regeneratorRuntime.mark((function t(){var e,n,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e=v(this.children),t.prev=1,e.s();case 3:if((n=e.n()).done){t.next=9;break}return i=n.value,t.next=7,this.layoutChild(i);case 7:t.next=3;break;case 9:t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](1),e.e(t.t0);case 14:return t.prev=14,e.f(),t.finish(14);case 17:case"end":return t.stop()}}),t,this,[[1,11,14,17]])})))}},{key:"layoutChild",value:function(t){return Y(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.layout();case 2:"absolute"!=t.position&&("vertical"==this.option.direction?(t.offsetTop=this.childOffsetTop,this.childOffsetTop+=t.offsetHeight):(t.offsetLeft=this.childOffsetLeft,this.childOffsetLeft+=t.offsetWidth));case 3:case"end":return e.stop()}}),e,this)})))}},{key:"calcContainerWidth",value:function(){if("number"==typeof this.option.width)return this.option.width;switch(this.option.direction){case"vertical":return this.childrenMaxWidth();case"horizontal":return this.childOffsetLeft;default:throw new TypeError("Unknown direction")}}},{key:"calcContainerHeight",value:function(){if("number"==typeof this.option.height)return this.option.height;switch(this.option.direction){case"vertical":return this.childOffsetTop;case"horizontal":return this.childrenMaxHeight();default:throw new TypeError("Unknown direction")}}},{key:"paint",value:function(){return Y(this,void 0,void 0,regeneratorRuntime.mark((function t(){var e,n,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e=v(this.children),t.prev=1,e.s();case 3:if((n=e.n()).done){t.next=9;break}return i=n.value,t.next=7,i.paint();case 7:t.next=3;break;case 9:t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](1),e.e(t.t0);case 14:return t.prev=14,e.f(),t.finish(14);case 17:case"end":return t.stop()}}),t,this,[[1,11,14,17]])})))}},{key:"childrenMaxWidth",value:function(){return Math.max.apply(Math,(0,c.default)(this.children.map((function(t){return t.offsetWidth}))).concat([0]))}},{key:"childrenMaxHeight",value:function(){return Math.max.apply(Math,(0,c.default)(this.children.map((function(t){return t.offsetHeight}))).concat([0]))}}]),n}(m),D=function(t,e,n,i){return new(n||(n=Promise))((function(r,o){function a(t){try{c(i.next(t))}catch(t){o(t)}}function u(t){try{c(i.throw(t))}catch(t){o(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}c((i=i.apply(t,e||[])).next())}))},H=function(t){(0,s.default)(n,t);var e=w(n);function n(t,i,o){var a;return(0,h.default)(this,n),a=e.call(this,t,i,o),a.contentElement=J(t,i.content,(0,r.default)(a)),a.clipPath=A((0,r.default)(a),i.path),a}return(0,d.default)(n,[{key:"_layout",value:function(){return this.contentElement.layout()}},{key:"paint",value:function(){return D(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.painter.ctx.save(),t.next=3,this.clipPath.paint();case 3:return this.painter.ctx.clip(),t.next=6,this.contentElement.paint();case 6:this.painter.ctx.restore();case 7:case"end":return t.stop()}}),t,this)})))}}]),n}(m),U=function(t,e,n,i){return new(n||(n=Promise))((function(r,o){function a(t){try{c(i.next(t))}catch(t){o(t)}}function u(t){try{c(i.throw(t))}catch(t){o(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}c((i=i.apply(t,e||[])).next())}))},N=function(t){(0,s.default)(n,t);var e=w(n);function n(t,i,o){var a,u,c;return(0,h.default)(this,n),a=e.call(this,t,i,o),a.contentElement=J(t,i.content,(0,r.default)(a)),a.transformOptions=null!==(u=i.transform)&&void 0!==u?u:[],a.transformOrigin=null!==(c=i.transformOrigin)&&void 0!==c?c:["center","center"],a}return(0,d.default)(n,[{key:"_layout",value:function(){return this.contentElement.layout()}},{key:"paint",value:function(){return U(this,void 0,void 0,regeneratorRuntime.mark((function t(){var e=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.painter.ctx.save(),this.withTransformOrigin((function(){return e.transform()})),t.next=4,this.contentElement.paint();case 4:this.painter.ctx.restore();case 5:case"end":return t.stop()}}),t,this)})))}},{key:"transform",value:function(){var t=this;this.transformOptions.forEach((function(e){return t.singleTransform(e)}))}},{key:"singleTransform",value:function(t){var e,n,i,r;switch(t.type){case"translate":return this.painter.ctx.translate(this.painter.upx2px(null!==(e=t.x)&&void 0!==e?e:0),this.painter.upx2px(null!==(n=t.y)&&void 0!==n?n:0));case"rotate":return this.painter.ctx.rotate(t.rotate/180*Math.PI);case"scale":return this.painter.ctx.scale(null!==(i=t.scaleWidth)&&void 0!==i?i:1,null!==(r=t.scaleHeight)&&void 0!==r?r:1);case"set-matrix":return this.painter.ctx.setTransform(t.scaleX,t.skewX,t.skewY,t.scaleY,this.painter.upx2px(t.translateX),this.painter.upx2px(t.translateY));default:throw new Error("Unknown transform type.")}}},{key:"withTransformOrigin",value:function(t){var e={x:this.elementX+this.contentWidth*{left:0,center:.5,right:1}[this.transformOrigin[0]],y:this.elementY+this.contentHeight*{top:0,center:.5,bottom:1}[this.transformOrigin[1]]};this.singleTransform({type:"translate",x:e.x,y:e.y}),t(),this.singleTransform({type:"translate",x:-e.x,y:-e.y})}}]),n}(m);function J(t,e,n){switch(e.type){case"text":return new O(t,e,n);case"text-block":return new R(t,e,n);case"image":return new M(t,e,n);case"line":return new k(t,e,n);case"rect":return new X(t,e,n);case"container":return new B(t,e,n);case"clip":return new H(t,e,n);case"transform":return new N(t,e,n);default:throw new TypeError("Unkown painter element type")}}var G=function(){var t;if("function"==typeof l.upx2px)return l.upx2px;var e=(null!==(t=l.getSystemInfoSync().screenWidth)&&void 0!==t?t:375)/750;return function(t){return t*e}}(),$=[.296,.313,.436,.638,.586,.89,.87,.256,.334,.334,.455,.742,.241,.433,.241,.427,.586,.586,.586,.586,.586,.586,.586,.586,.586,.586,.241,.241,.742,.742,.742,.483,1.031,.704,.627,.669,.762,.55,.531,.744,.773,.294,.396,.635,.513,.977,.813,.815,.612,.815,.653,.577,.573,.747,.676,1.018,.645,.604,.62,.334,.416,.334,.742,.448,.295,.553,.639,.501,.64,.567,.347,.64,.616,.266,.267,.544,.266,.937,.616,.636,.639,.64,.382,.463,.373,.616,.525,.79,.507,.529,.492,.334,.269,.334,.742,.296],q=function(t,e,n,i){return new(n||(n=Promise))((function(r,o){function a(t){try{c(i.next(t))}catch(t){o(t)}}function u(t){try{c(i.throw(t))}catch(t){o(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}c((i=i.apply(t,e||[])).next())}))},K=P(),Q=function(t){(0,s.default)(n,t);var e=w(n);function n(t,i){var r;return(0,h.default)(this,n),r=e.call(this,i),r.painter=t,r}return(0,d.default)(n,[{key:"drawImageWithSrc",value:function(t,e,i,r,o,u,c,s,l){var h=this,d=Object.create(null,{drawImage:{get:function(){return(0,a.default)((0,f.default)(n.prototype),"drawImage",h)}}});return q(this,void 0,void 0,regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:"number"==typeof u&&"number"==typeof c&&"number"==typeof s&&"number"==typeof l?d.drawImage.call(this,t,e,i,r,o,u,c,s,l):d.drawImage.call(this,t,e,i,r,o);case 1:case"end":return n.stop()}}),n,this)})))}},{key:"measureTextWidth",value:function(t,e){var n;return this.setFontSize(e),null!==(n=this.measureText(t).width)&&void 0!==n?n:0}}]),n}(K),V=function(t){(0,s.default)(n,t);var e=w(n);function n(){return(0,h.default)(this,n),e.apply(this,arguments)}return(0,d.default)(n,[{key:"measureTextWidth",value:function(t,e){return t.split("").reduce((function(t,e){var n=e.charCodeAt(0);return t+($[n-32]||1)}),0)*e}}]),n}(Q),Z=function(t,e,n,i){return new(n||(n=Promise))((function(r,o){function a(t){try{c(i.next(t))}catch(t){o(t)}}function u(t){try{c(i.throw(t))}catch(t){o(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}c((i=i.apply(t,e||[])).next())}))},tt=function(t){(0,s.default)(n,t);var e=w(n);function n(){return(0,h.default)(this,n),e.apply(this,arguments)}return(0,d.default)(n,[{key:"measureTextWidth",value:function(t,e){var i;return"top"==t&&console.log("measureText("+t+").width=",(0,a.default)((0,f.default)(n.prototype),"measureText",this).call(this,t).width),(null!==(i=(0,a.default)((0,f.default)(n.prototype),"measureText",this).call(this,t).width)&&void 0!==i?i:0)/10*e}},{key:"drawImageWithSrc",value:function(t,e,i,r,o,u,c,s,l){var h=this,d=Object.create(null,{drawImageWithSrc:{get:function(){return(0,a.default)((0,f.default)(n.prototype),"drawImageWithSrc",h)}}});return Z(this,void 0,void 0,regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:"number"==typeof u&&"number"==typeof c&&"number"==typeof s&&"number"==typeof l?d.drawImageWithSrc.call(this,t,u,c,s,l,e,i,r,o):d.drawImageWithSrc.call(this,t,e,i,r,o);case 1:case"end":return n.stop()}}),n,this)})))}}]),n}(Q),et=function(t){(0,s.default)(n,t);var e=w(n);function n(){return(0,h.default)(this,n),e.apply(this,arguments)}return(0,d.default)(n,[{key:"arcTo",value:function(t,e,i,r,o){return o<2?this.lineTo(t,e):(0,a.default)((0,f.default)(n.prototype),"arcTo",this).call(this,t,e,i,r,o)}},{key:"measureTextWidth",value:function(t,e){return(t.includes("\n")||t.includes("\r"))&&console.warn('mp-painter:measureText:字符串 "'.concat(t,'" 中包含换行符，结果在 iPhone 上可能不准确')),(0,a.default)((0,f.default)(n.prototype),"measureTextWidth",this).call(this,t,e)}}]),n}(Q),nt=function(t,e,n,i){return new(n||(n=Promise))((function(r,o){function a(t){try{c(i.next(t))}catch(t){o(t)}}function u(t){try{c(i.throw(t))}catch(t){o(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}c((i=i.apply(t,e||[])).next())}))},it=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.platform,o=void 0===r?i:r,a=n.upx2px;(0,h.default)(this,t),this.platform=o,this.upx2px=null!=a?a:G,"mp-alipay"==o&&(this.upx2px=function(t){return(null!=a?a:G)(2*t)}),this.ctx=function(t,e){switch(t.platform){case"h5":return new I(t,e);case"mp-weixin":return new et(t,e);case"mp-alipay":return new V(t,e);case"mp-baidu":return new tt(t,e);default:throw new Error("mp-painter: unexpect platform :"+t.platform)}}(this,e)}return(0,d.default)(t,[{key:"draw",value:function(t){return nt(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n,i,r=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=J(this,t),e.next=3,n.layout();case 3:return i=e.sent,e.next=6,n.paint();case 6:return e.next=8,new Promise((function(t){return r.ctx.draw(!0,t)}));case 8:return e.next=10,function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return new Promise((function(e){return setTimeout(e,t)}))}(100);case 10:return e.abrupt("return",i);case 11:case"end":return e.stop()}}),e,this)})))}},{key:"createElement",value:function(t){return J(this,t)}},{key:"layout",value:function(t){return nt(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.createElement(t).layout();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})))}},{key:"toJSON",value:function(){return"Painter Instance"}}]),t}()}])},d225:function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.r(e),n.d(e,"default",(function(){return i}))},d2d5:function(t,e,n){n("1654"),n("549b"),t.exports=n("584a").Array.from},d3d7:function(t,e,n){t.exports=n("8e9e")},db2a:function(t,e,n){"use strict";function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}n.d(e,"a",(function(){return i}))},dc62:function(t,e,n){n("9427");var i=n("584a").Object;t.exports=function(t,e){return i.create(t,e)}},e0b8:function(t,e,n){"use strict";var i=n("7726"),r=n("5ca1"),o=n("2aba"),a=n("dcbc"),u=n("67ab"),c=n("4a59"),s=n("f605"),l=n("d3f4"),f=n("79e5"),h=n("5cc5"),d=n("7f20"),p=n("5dbc");t.exports=function(t,e,n,v,y,m){var w=i[t],x=w,b=y?"set":"add",g=x&&x.prototype,k={},S=function(t){var e=g[t];o(g,t,"delete"==t||"has"==t?function(t){return!(m&&!l(t))&&e.call(this,0===t?0:t)}:"get"==t?function(t){return m&&!l(t)?void 0:e.call(this,0===t?0:t)}:"add"==t?function(t){return e.call(this,0===t?0:t),this}:function(t,n){return e.call(this,0===t?0:t,n),this})};if("function"==typeof x&&(m||g.forEach&&!f((function(){(new x).entries().next()})))){var O=new x,j=O[b](m?{}:-0,1)!=O,T=f((function(){O.has(1)})),R=h((function(t){new x(t)})),_=!m&&f((function(){var t=new x,e=5;while(e--)t[b](e,e);return!t.has(-0)}));R||(x=e((function(e,n){s(e,x,t);var i=p(new w,e,x);return void 0!=n&&c(n,y,i[b],i),i})),x.prototype=g,g.constructor=x),(T||_)&&(S("delete"),S("has"),y&&S("get")),(_||j)&&S(b),m&&g.clear&&delete g.clear}else x=v.getConstructor(e,t,y,b),a(x.prototype,n),u.NEED=!0;return d(x,t),k[t]=x,r(r.G+r.W+r.F*(x!=w),k),m||v.setStrong(x,t,y),x}},e630:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var i=n("774e"),r=n.n(i),o=n("db2a");function a(t,e){if(t){if("string"===typeof t)return Object(o["a"])(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?r()(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Object(o["a"])(t,e):void 0}}},ead6:function(t,e,n){var i=n("f772"),r=n("e4ae"),o=function(t,e){if(r(t),!i(e)&&null!==e)throw TypeError(e+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,e,i){try{i=n("d864")(Function.call,n("bf0b").f(Object.prototype,"__proto__").set,2),i(t,[]),e=!(t instanceof Array)}catch(r){e=!0}return function(t,n){return o(t,n),e?t.__proto__=n:i(t,n),t}}({},!1):void 0),check:o}},f400:function(t,e,n){"use strict";var i=n("c26b"),r=n("b39a"),o="Map";t.exports=n("e0b8")(o,(function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}}),{get:function(t){var e=i.getEntry(r(this,o),t);return e&&e.v},set:function(t,e){return i.def(r(this,o),0===t?0:t,e)}},i,!0)},f410:function(t,e,n){n("1af6"),t.exports=n("584a").Array.isArray},fa99:function(t,e,n){n("0293"),t.exports=n("584a").Object.getPrototypeOf},fde4:function(t,e,n){n("bf90");var i=n("584a").Object;t.exports=function(t,e){return i.getOwnPropertyDescriptor(t,e)}}}]);